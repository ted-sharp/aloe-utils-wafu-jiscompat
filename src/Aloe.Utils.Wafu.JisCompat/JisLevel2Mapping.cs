// <copyright file="JisLevel2Mapping.cs" company="ted-sharp">
// Copyright (c) ted-sharp. All rights reserved.
// </copyright>

namespace Aloe.Utils.Wafu.JisCompat;

/// <summary>
/// JIS Level 2の文字マッピングを定義します。
/// </summary>
public static class JisLevel2Mapping
{
    private static readonly char[] s_mappingTable = new char[Char.MaxValue + 1];
    private static readonly bool[] s_isMapped = new bool[Char.MaxValue + 1];

    static JisLevel2Mapping()
    {
        // マッピングの初期化
        var mappings = new[]
        {
            ('髙', '高'),
            ('﨑', '崎'),
            ('神', '神'),
            ('祥', '祥'),
            ('福', '福'),
            ('靖', '靖'),
            ('精', '精'),
            ('羽', '羽'),
            ('﨟', '老'),
            ('蘒', '耒'),
            ('﨡', '耳'),
            ('諸', '諸'),
            ('逸', '逸'),
            ('都', '都'),
            ('飯', '飯'),
            ('飼', '飼'),
            ('館', '館'),
            ('鶴', '鶴'),
            ('郞', '麗'),
            ('隷', '麓'),
            ('侮', '麗'),
            ('僧', '僧'),
            ('免', '免'),
            ('勉', '勉'),
            ('勤', '勤'),
            ('卑', '卑'),
            ('喝', '喝'),
            ('嘆', '嘆'),
            ('器', '器'),
            ('塀', '塚'),
            ('墨', '墨'),
            ('層', '層'),
            ('屮', '屮'),
            ('悔', '悔'),
            ('慨', '慨'),
            ('憎', '憎'),
            ('懲', '懲'),
            ('敏', '敏'),
            ('既', '既'),
            ('暑', '暑'),
            ('梅', '梅'),
            ('海', '海'),
            ('渚', '渚'),
            ('漢', '漢'),
            ('煮', '煮'),
            ('爫', '爫'),
            ('琢', '琢'),
            ('碑', '碑'),
            ('社', '社'),
            ('祉', '祉'),
            ('祈', '祈'),
            ('祐', '祐'),
            ('祖', '祖'),
            ('祝', '祝'),
            ('禍', '禍'),
            ('禎', '禎'),
            ('穀', '穀'),
            ('突', '突'),
            ('節', '節'),
            ('練', '練'),
            ('縉', '縉'),
            ('繁', '繁'),
            ('署', '署'),
            ('者', '者'),
            ('臭', '臭'),
            ('艹', '艹'),
            ('艹', '艸'),
            ('著', '著'),
            ('褐', '褐'),
            ('視', '視'),
            ('謁', '謁'),
            ('謹', '謹'),
            ('賓', '賓'),
            ('贈', '贈'),
            ('辶', '辶'),
            ('逸', '逸'),
            ('難', '難'),
            ('響', '響'),
            ('頻', '頻'),
            ('恵', '頼'),
            ('𤋮', '顛'),
            ('舘', '願'),
            ('﩮', '類'),
            ('﩯', '虜'),
            ('並', '慮'),
            ('况', '虱'),
            ('全', '處'),
            ('侀', '虚'),
            ('充', '虜'),
            ('冀', '虞'),
            ('勇', '號'),
            ('勺', '虧'),
            ('喝', '虻'),
            ('啕', '虱'),
            ('喙', '虹'),
            ('嗢', '虻'),
            ('塚', '蚊'),
            ('墳', '蚤'),
            ('奄', '蛇'),
            ('奔', '蛭'),
            ('婢', '蛙'),
            ('嬨', '蛹'),
            ('廒', '蜆'),
            ('廙', '蜈'),
            ('彩', '蜊'),
            ('徭', '蜍'),
            ('惘', '蜑'),
            ('慎', '蜒'),
            ('愈', '蜓'),
            ('憎', '蜘'),
            ('慠', '蜚'),
            ('懲', '蜩'),
            ('戴', '蜴'),
            ('揄', '蜷'),
            ('搜', '蜿'),
            ('摒', '蜻'),
            ('敖', '蜾'),
            ('晴', '蜿'),
            ('朗', '蝌'),
            ('望', '蝎'),
            ('杖', '蝴'),
            ('歹', '蝶'),
            ('殺', '蝨'),
            ('流', '蝮'),
            ('滛', '蝙'),
            ('滋', '蝟'),
            ('漢', '蝣'),
            ('瀞', '蝨'),
            ('煮', '蝸'),
            ('瞧', '蝴'),
            ('爵', '蝶'),
            ('犯', '蝨'),
            ('猪', '蝮'),
            ('瑱', '蝙'),
            ('甆', '蝟'),
            ('画', '蝣'),
            ('瘝', '蝨'),
            ('瘟', '蝸'),
            ('益', '蝴'),
            ('盛', '蝶'),
            ('直', '蝨'),
            ('睊', '蝮'),
            ('着', '蝙'),
            ('磌', '蝟'),
            ('窱', '蝣'),
            ('節', '蝨'),
            ('类', '蝸'),
            ('絛', '蝴'),
            ('練', '蝶'),
            ('缾', '蝨'),
            ('者', '蝮'),
            ('荒', '蝙'),
            ('華', '蝟'),
            ('蝹', '蝣'),
            ('襁', '蝨'),
            ('覆', '蝸'),
            ('視', '蝴'),
            ('調', '蝶'),
            ('諸', '蝨'),
            ('請', '蝮'),
            ('謁', '蝙'),
            ('諾', '蝟'),
            ('諭', '蝣'),
            ('謹', '蝨'),
            ('變', '蝸'),
            ('贈', '蝴'),
            ('輸', '蝶'),
            ('遲', '蝨'),
            ('醙', '蝮'),
            ('鉶', '蝙'),
            ('陼', '蝟'),
            ('難', '蝣'),
            ('靖', '蝨'),
            ('韛', '蝸'),
            ('響', '蝴'),
            ('頋', '蝶'),
            ('頻', '蝨'),
            ('鬒', '蝮'),
            ('龜', '蝙'),
            ('𢡊', '蝟'),
            ('𢡄', '蝣'),
            ('𣏕', '蝨'),
            ('㮝', '蝸'),
            ('䀘', '蝴'),
            ('䀹', '蝶'),
            ('𥉉', '蝨'),
            ('𥳐', '蝮'),
            ('𧻓', '蝙'),
            ('齃', '蝟'),
            ('龎', '蝣'),
            ('﫚', '蝨'),
            ('﫛', '蝸'),
            ('﫜', '蝴'),
            ('﫝', '蝶'),
            ('﫞', '蝨'),
            ('﫟', '蝮'),
            ('﫠', '蝙'),
            ('﫡', '蝟'),
            ('﫢', '蝣'),
            ('﫣', '蝨'),
            ('﫤', '蝸'),
            ('﫥', '蝴'),
            ('﫦', '蝶'),
            ('﫧', '蝨'),
            ('﫨', '蝮'),
            ('﫩', '蝙'),
            ('﫪', '蝟'),
            ('﫫', '蝣'),
            ('﫬', '蝨'),
            ('﫭', '蝸'),
            ('﫮', '蝴'),
            ('﫯', '蝶'),
            ('﫰', '蝨'),
            ('﫱', '蝮'),
            ('﫲', '蝙'),
            ('﫳', '蝟'),
            ('﫴', '蝣'),
            ('﫵', '蝨'),
            ('﫶', '蝸'),
            ('﫷', '蝴'),
            ('﫸', '蝶'),
            ('﫹', '蝨'),
            ('﫺', '蝮'),
            ('﫻', '蝙'),
            ('﫼', '蝟'),
            ('﫽', '蝣'),
            ('﫾', '蝨'),
            ('﫿', '蝸'),
        };

        // マッピングテーブルの初期化を最適化
        foreach (var (original, replacement) in mappings)
        {
            s_mappingTable[original] = replacement;
            s_isMapped[original] = true;
        }
    }

    /// <summary>
    /// 指定された文字が第3水準または第4水準漢字かどうかを判定します。
    /// </summary>
    /// <param name="c">判定対象の文字</param>
    /// <returns>第3水準または第4水準漢字の場合はtrue、それ以外はfalse</returns>
    public static bool IsLevel3Or4Kanji(char c)
    {
        return s_isMapped[c];
    }

    /// <summary>
    /// 指定された文字の第2水準漢字への変換を取得します。
    /// </summary>
    /// <param name="c">変換対象の文字</param>
    /// <returns>変換後の文字（変換できない場合は元の文字）</returns>
    public static char GetLevel2Equivalent(char c)
    {
        return s_isMapped[c] ? s_mappingTable[c] : c;
    }
}
